/**
  *
  * JamComments
  * Author: Alex MacArthur <alex@macarthur.me> (https://macarthur.me)
  * Version: v0.0.10
  * License: GPL-2.0
  * URL: https://jamcomments.com
  *
  */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react"),require("jam-comments-utilities/shared/getServiceEndpoint")):"function"==typeof define&&define.amd?define(["react","jam-comments-utilities/shared/getServiceEndpoint"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).JamComments=t(e.React,e.getServiceEndpoint)}(this,(function(e,t){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=n(e),a=n(t);function o(e,t,n,r,a,o,i){try{var c=e[o](i),m=c.value}catch(e){return void n(e)}c.done?t(m):Promise.resolve(m).then(r,a)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function c(e){o(i,r,a,c,m,"next",e)}function m(e){o(i,r,a,c,m,"throw",e)}c(void 0)}))}}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||d(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===n&&r.firstChild?r.insertBefore(a,r.firstChild):r.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}p(".jc-Message {\n  margin-bottom: 1rem;\n  border-radius: var(--border-radius);\n  padding: .75rem 1rem;\n  color: white; }\n  .jc-Message p {\n    margin: 0; }\n\n.jc-Message--error {\n  background: var(--jc-red); }\n\n.jc-Message--success {\n  background: var(--jc-green); }\n");var g=function(e){var t=e.children,n=e.isSuccessful,a=void 0!==n&&n?"jc-Message--success":"jc-Message--error";return r.default.createElement("div",{className:"jc-Message ".concat(a)},r.default.createElement("p",null,t))};p(".jc-CommentBox {\n  position: relative; }\n  .jc-CommentBox-loadingDots {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translateX(-50%); }\n    .jc-CommentBox-loadingDots svg {\n      fill: var(--jc-loading); }\n  .jc-CommentBox-attribution {\n    opacity: .5;\n    text-align: right;\n    padding-top: 5px;\n    font-size: .65em; }\n    .jc-CommentBox-attribution a {\n      text-decoration: none;\n      color: inherit; }\n  .jc-CommentBox-inputs.is-submitting {\n    opacity: .15;\n    pointer-events: none; }\n  .jc-CommentBox-form {\n    display: grid;\n    grid-template-columns: 1fr;\n    grid-gap: 1rem;\n    margin-bottom: 30px; }\n    @media screen and (min-width: 900px) {\n      .jc-CommentBox-form {\n        grid-template-columns: 1fr 1fr; } }\n  .jc-CommentBox input,\n  .jc-CommentBox textarea {\n    border: 2px solid var(--jc-gray);\n    border-radius: var(--border-radius);\n    padding: 8px; }\n  .jc-CommentBox textarea {\n    min-height: 100px; }\n  .jc-CommentBox-textarea, .jc-CommentBox-buttonWrapper {\n    grid-column: 1 / -1; }\n  .jc-CommentBox-buttonWrapper {\n    margin-top: 1.5rem; }\n  .jc-CommentBox-label {\n    display: flex;\n    flex-direction: column; }\n    .jc-CommentBox-label input,\n    .jc-CommentBox-label textarea {\n      margin-top: 3px; }\n");function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var b=({styles:e={},...t})=>r.default.createElement("svg",v({width:"120",height:"30",xmlns:"http://www.w3.org/2000/svg",fill:"#fff"},t),r.default.createElement("circle",{cx:"15",cy:"15",r:"15"},r.default.createElement("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),r.default.createElement("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})),r.default.createElement("circle",{cx:"60",cy:"15",r:"9",fillOpacity:".3"},r.default.createElement("animate",{attributeName:"r",from:"9",to:"9",begin:"0s",dur:"0.8s",values:"9;15;9",calcMode:"linear",repeatCount:"indefinite"}),r.default.createElement("animate",{attributeName:"fill-opacity",from:".5",to:".5",begin:"0s",dur:"0.8s",values:".5;1;.5",calcMode:"linear",repeatCount:"indefinite"})),r.default.createElement("circle",{cx:"105",cy:"15",r:"15"},r.default.createElement("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),r.default.createElement("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})));function h(e){return j.apply(this,arguments)}function j(){return(j=i(regeneratorRuntime.mark((function e(t){var n,r,a,o,i,c,m,s,u,d,f,p,g,v,b,h;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.endpoint,r=t.fetchOptions,a=t.query,o=t.variables,i={query:a,variables:JSON.stringify(o)},c=r.method,m=void 0===c?"POST":c,s=r.headers,u=void 0===s?{}:s,d="get"===m.toLowerCase(),f=d?function(e,t){var n=new URL(e);for(var r in t)n.searchParams.append(r,t[r]);return n.toString()}(n,i):n,e.prev=2,e.next=5,fetch(f,{method:m.toUpperCase(),headers:l({"Content-Type":"application/"+(d?"x-www-form-urlencoded":"json")},u),body:d?null:JSON.stringify(i)});case 5:return p=e.sent,e.next=8,p.json();case 8:return g=e.sent,v=g.data,b=g.errors,h={data:v},e.abrupt("return",(b&&(h.errors=b),h));case 15:return e.prev=15,e.t0=e.catch(2),e.abrupt("return",{errors:[e.t0]});case 18:case"end":return e.stop()}}),e,null,[[2,15]])})))).apply(this,arguments)}var y=function(e){var t,n=e.endpoint,r=e.method,a=e.headers;return{send:(t=i(regeneratorRuntime.mark((function e(t){var o,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=i.length>1&&void 0!==i[1]?i[1]:{},e.next=3,h({endpoint:n,query:t,variables:o,fetchOptions:{method:r,headers:a}});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}}({endpoint:"".concat(a.default(process.env.JAM_COMMENTS_SERVICE_ENDPOINT),"/graphql"),headers:{"x-api-key":process.env.GATSBY_JAM_COMMENTS_API_KEY}}),C=process.env.GATSBY_JAM_COMMENTS_DOMAIN,x=function(){return(new Date).getTime()},E=function(t){var n=t.newComment,a=function(){var t=e.useRef(!1);return e.useEffect((function(){return t.current=!0,function(){return t.current=!1}}),[]),t}(),o=e.useRef(null),c=s(e.useState(!1),2),m=c[0],l=c[1],d=s(e.useState(""),2),f=d[0],p=d[1],v=s(e.useState(!1),2),h=v[0],j=v[1],E=function(){var e=i(regeneratorRuntime.mark((function e(t){var r,i,c,m,s,d,f,g,v,b;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=x(),t.preventDefault(),p(""),l(!0),h=o.current,i=u(h.elements).reduce((function(e,t){return e[t.name]=t.value,e}),{}),o.current.reset(),"\n      mutation CreateComment(\n        $name: String!,\n        $path: String!,\n        $content: String!,\n        $domain: String!,\n        $emailAddress: String\n      ){\n        createComment(\n          name: $name,\n          path: $path,\n          content: $content,\n          emailAddress: $emailAddress\n          domain: $domain\n        ) {\n          createdAt\n          name\n          emailAddress\n          content\n          id\n          site {\n            domain\n          }\n        }\n      }\n    ",c=i.name,m=i.content,s=i.emailAddress,d={name:c,domain:C,content:m,emailAddress:s,path:window.location.pathname},e.prev=9,e.next=12,y.send("\n      mutation CreateComment(\n        $name: String!,\n        $path: String!,\n        $content: String!,\n        $domain: String!,\n        $emailAddress: String\n      ){\n        createComment(\n          name: $name,\n          path: $path,\n          content: $content,\n          emailAddress: $emailAddress\n          domain: $domain\n        ) {\n          createdAt\n          name\n          emailAddress\n          content\n          id\n          site {\n            domain\n          }\n        }\n      }\n    ",d);case 12:if(f=e.sent,!(null===(g=f)||void 0===g||null===(v=g.errors)||void 0===v?void 0:v.length)){e.next=17;break}return console.log(f.errors[0].message),p("Sorry, something went wrong!"),e.abrupt("return");case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(9),p("Sorry, something went wrong!"),l(!1);case 23:return e.prev=23,b=1e3-(x()-r),setTimeout((function(){var e,t;a.current&&(l(!1),(null===(e=f)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.createComment)&&n(f.data.createComment))}),b>0?b:0),e.finish(23);case 28:case"end":return e.stop()}var h}),e,null,[[9,19,23,28]])})));return function(t){return e.apply(this,arguments)}}();return r.default.createElement("div",{className:"jc-CommentBox"},m&&r.default.createElement("div",{className:"jc-CommentBox-loadingDots"},r.default.createElement(b,null)),r.default.createElement("div",{className:"jc-CommentBox-inputs ".concat(m?"is-submitting":"")},r.default.createElement("h3",null,"Leave a Comment"),f&&r.default.createElement(g,null,f),r.default.createElement("form",{onSubmit:E,ref:o,className:"jc-CommentBox-form"},r.default.createElement("label",{className:"jc-CommentBox-label jc-CommentBox-textarea"},r.default.createElement("textarea",{name:"content",required:!0,onFocus:function(){return!h&&j(!0)}}),r.default.createElement("small",{className:"jc-CommentBox-attribution"},"Powered by"," ",r.default.createElement("a",{tabIndex:"-1",href:"https://jamcomments.com",rel:"noreferrer noopener",target:"_blank"},"JamComments"))),h&&r.default.createElement(r.default.Fragment,null,r.default.createElement("label",{className:"jc-CommentBox-label"},"Name",r.default.createElement("input",{type:"text",name:"name",required:!0})),r.default.createElement("label",{className:"jc-CommentBox-label"},"Email Address",r.default.createElement("input",{type:"email",name:"emailAddress"})),r.default.createElement("span",{className:"jc-CommentBox-buttonWrapper"},r.default.createElement("button",{className:"jc-CommentBox-button"},"Submit"))))))},w=function(e){return new Date(Number(e))};p(".jc-Comment * {\n  font: inherit; }\n\n.jc-Comment-details {\n  display: flex;\n  align-items: center;\n  color: var(--jc-gray-dark);\n  margin-bottom: 15px; }\n\n.jc-Comment-content {\n  padding-bottom: 12px; }\n\n.jc-Comment-name {\n  margin: 0;\n  font-weight: bold; }\n\n.jc-Comment-date {\n  line-height: normal;\n  font-size: .75em;\n  color: var(--jc-gray-dark);\n  display: block; }\n\n.jc-Comment-anchor {\n  padding: 0 .05rem 0 .5rem;\n  font-weight: bold;\n  text-decoration: none;\n  color: inherit;\n  font-weight: normal; }\n  .jc-Comment-anchor:visited {\n    color: inherit; }\n");var S=function(t){var n,a=t.comment;return a.content=e.useMemo((function(){return a.content.replace(/\n/g,"<br>\n")}),[]),r.default.createElement("div",{className:"jc-Comment"},r.default.createElement("span",{className:"jc-Comment-details"},r.default.createElement("h6",{className:"jc-Comment-name"},a.name),r.default.createElement("a",{className:"jc-Comment-anchor",href:"#comment-".concat(a.id),"aria-label":"comment anchor link"},r.default.createElement("time",{className:"jc-Comment-date",dateTime:(n=a.createdAt,w(n).toISOString())},function(e){var t=w(e),n=t.getTimezoneOffset()/60;return t.setHours(t.getHours()-n),t.toLocaleString("en-US").split(",")[0].trim()}(a.createdAt)))),r.default.createElement("div",{className:"jc-Comment-content"},r.default.createElement("p",{dangerouslySetInnerHTML:{__html:a.content}})))};p(".jc-CommentList {\n  overflow: hidden; }\n  .jc-CommentList-count {\n    position: relative;\n    display: inline-block;\n    margin-bottom: 1rem; }\n    .jc-CommentList-count:after {\n      content: '';\n      display: block;\n      position: absolute;\n      width: 100vw;\n      height: 2px;\n      background: var(--jc-gray);\n      top: 50%;\n      left: calc(100% + 20px);\n      transform: translateY(-50%); }\n  .jc-CommentList-list {\n    list-style: none;\n    padding: 0;\n    margin: 0; }\n  .jc-CommentList-item {\n    position: relative;\n    margin-top: 2rem; }\n    .jc-CommentList-item:after {\n      content: '';\n      display: block;\n      position: absolute;\n      width: 100vw;\n      height: 2px;\n      background: var(--jc-gray);\n      top: 50%;\n      left: calc(100% + 20px);\n      transform: translateY(-50%); }\n    .jc-CommentList-item:after {\n      position: relative;\n      width: 50px;\n      left: 0;\n      top: auto;\n      transform: none;\n      margin-bottom: 2rem; }\n    .jc-CommentList-item:last-child {\n      margin-top: 0; }\n");var N=function(e){var t,n=e.comments;return r.default.createElement("div",{className:"jc-CommentList"},r.default.createElement("span",{className:"jc-CommentList-count"},n.length," ",(t="comment",1===n.length?t:"".concat(t,"s"))),r.default.createElement("ul",{className:"jc-CommentList-list"},n.map((function(e){return r.default.createElement("li",{key:e.id,className:"jc-CommentList-item"},r.default.createElement(S,{comment:e}))}))))};p(".jc-Shell {\n  --jc-red: #BA274A;\n  --jc-green: #5BBA6F;\n  --jc-gray: #dfdede;\n  --jc-gray-dark: #5c5c5c;\n  --border-radius: 5px;\n  --jc-loading: var(--jc-gray);\n  margin: 2rem 0; }\n");return function(t){var n=t.pageContext,a=n&&n.comments?n.comments:[],o=s(e.useState(a),2),i=o[0],c=o[1];return r.default.createElement("div",{className:"jc-Shell"},r.default.createElement(E,{newComment:function(e){c([e].concat(u(i)))}}),r.default.createElement(N,{comments:i}))}}));
