/**
  *
  * JamComments
  * Author: Alex MacArthur <alex@macarthur.me> (https://macarthur.me)
  * Version: v0.1.0
  * License: MIT
  * URL: https://github.com/alexmacarthur/gatsby-plugin-jam-comments#readme
  *
  */
import e,{useRef as t}from"react";import r from"stream";import n from"encoding";import o from"http";import a from"url";import i from"https";import s from"zlib";function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t,r,n,o,a,i){try{var s=e[a](i),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,o)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function d(e,t,r){return t&&f(e.prototype,t),r&&f(e,r),e}function h(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||p(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){if(e){if("string"==typeof e)return y(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(e,t):void 0}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function m(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=p(e))){var t=0,r=function(){};return{s:r,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,o,a=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){i=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(i)throw o}}}}var b="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function v(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function g(e,t){return e(t={exports:{}},t.exports),t.exports}var w=g((function(e,t){var r,n=b&&b.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(r,n){var o=this,a=t.extractMessage(r)+": "+JSON.stringify({response:r,request:n});return(o=e.call(this,a)||this).response=r,o.request=n,"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(o,t),o}return n(t,e),t.extractMessage=function(e){try{return e.errors[0].message}catch(t){return"GraphQL Error (Code: "+e.status+")"}},t}(Error);t.ClientError=o}));v(w);w.ClientError;var S=Symbol("buffer"),O=Symbol("type"),j=function(){function e(){l(this,e),this[O]="";var t=arguments[0],r=arguments[1],n=[];if(t)for(var o=t,a=Number(o.length),i=0;i<a;i++){var s=o[i],u=void 0;u=s instanceof Buffer?s:ArrayBuffer.isView(s)?Buffer.from(s.buffer,s.byteOffset,s.byteLength):s instanceof ArrayBuffer?Buffer.from(s):s instanceof e?s[S]:Buffer.from("string"==typeof s?s:String(s)),n.push(u)}this[S]=Buffer.concat(n);var c=r&&void 0!==r.type&&String(r.type).toLowerCase();c&&!/[^\u0020-\u007E]/.test(c)&&(this[O]=c)}return d(e,[{key:"slice",value:function(){var t,r,n=this.size,o=arguments[0],a=arguments[1];t=void 0===o?0:o<0?Math.max(n+o,0):Math.min(o,n),r=void 0===a?n:a<0?Math.max(n+a,0):Math.min(a,n);var i=Math.max(r-t,0),s=this[S],u=s.slice(t,t+i),c=new e([],{type:arguments[2]});return c[S]=u,c}},{key:"size",get:function(){return this[S].length}},{key:"type",get:function(){return this[O]}}]),e}();function E(e,t,r){Error.call(this,e),this.message=e,this.type=t,r&&(this.code=this.errno=r.code),Error.captureStackTrace(this,this.constructor)}Object.defineProperties(j.prototype,{size:{enumerable:!0},type:{enumerable:!0},slice:{enumerable:!0}}),Object.defineProperty(j.prototype,Symbol.toStringTag,{value:"Blob",writable:!1,enumerable:!1,configurable:!0}),E.prototype=Object.create(Error.prototype),E.prototype.constructor=E,E.prototype.name="FetchError";var T,x=r.PassThrough;try{T=n.convert}catch(e){}var P=Symbol("Body internals");function k(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=n.size,a=void 0===o?0:o,i=n.timeout,s=void 0===i?0:i;null==e?e=null:"string"==typeof e||A(e)||e instanceof j||Buffer.isBuffer(e)||"[object ArrayBuffer]"===Object.prototype.toString.call(e)||e instanceof r||(e=String(e)),this[P]={body:e,disturbed:!1,error:null},this.size=a,this.timeout=s,e instanceof r&&e.on("error",(function(e){t[P].error=new E("Invalid response body while trying to fetch ".concat(t.url,": ").concat(e.message),"system",e)}))}function C(){var e=this;if(this[P].disturbed)return k.Promise.reject(new TypeError("body used already for: ".concat(this.url)));if(this[P].disturbed=!0,this[P].error)return k.Promise.reject(this[P].error);if(null===this.body)return k.Promise.resolve(Buffer.alloc(0));if("string"==typeof this.body)return k.Promise.resolve(Buffer.from(this.body));if(this.body instanceof j)return k.Promise.resolve(this.body[S]);if(Buffer.isBuffer(this.body))return k.Promise.resolve(this.body);if("[object ArrayBuffer]"===Object.prototype.toString.call(this.body))return k.Promise.resolve(Buffer.from(this.body));if(!(this.body instanceof r))return k.Promise.resolve(Buffer.alloc(0));var t=[],n=0,o=!1;return new k.Promise((function(r,a){var i;e.timeout&&(i=setTimeout((function(){o=!0,a(new E("Response timeout while trying to fetch ".concat(e.url," (over ").concat(e.timeout,"ms)"),"body-timeout"))}),e.timeout)),e.body.on("error",(function(t){a(new E("Invalid response body while trying to fetch ".concat(e.url,": ").concat(t.message),"system",t))})),e.body.on("data",(function(r){if(!o&&null!==r){if(e.size&&n+r.length>e.size)return o=!0,void a(new E("content size at ".concat(e.url," over limit: ").concat(e.size),"max-size"));n+=r.length,t.push(r)}})),e.body.on("end",(function(){if(!o){clearTimeout(i);try{r(Buffer.concat(t))}catch(t){a(new E("Could not create Buffer from response body for ".concat(e.url,": ").concat(t.message),"system",t))}}}))}))}function A(e){return"object"===u(e)&&"function"==typeof e.append&&"function"==typeof e.delete&&"function"==typeof e.get&&"function"==typeof e.getAll&&"function"==typeof e.has&&"function"==typeof e.set&&("URLSearchParams"===e.constructor.name||"[object URLSearchParams]"===Object.prototype.toString.call(e)||"function"==typeof e.sort)}function _(e){var t,n,o=e.body;if(e.bodyUsed)throw new Error("cannot clone body after it is used");return o instanceof r&&"function"!=typeof o.getBoundary&&(t=new x,n=new x,o.pipe(t),o.pipe(n),e[P].body=t,o=n),o}function B(e){var t=e.body;return null===t?null:"string"==typeof t?"text/plain;charset=UTF-8":A(t)?"application/x-www-form-urlencoded;charset=UTF-8":t instanceof j?t.type||null:Buffer.isBuffer(t)||"[object ArrayBuffer]"===Object.prototype.toString.call(t)?null:"function"==typeof t.getBoundary?"multipart/form-data;boundary=".concat(t.getBoundary()):null}function R(e){var t=e.body;return null===t?0:"string"==typeof t?Buffer.byteLength(t):A(t)?Buffer.byteLength(String(t)):t instanceof j?t.size:Buffer.isBuffer(t)?t.length:"[object ArrayBuffer]"===Object.prototype.toString.call(t)?t.byteLength:t&&"function"==typeof t.getLengthSync&&(t._lengthRetrievers&&0==t._lengthRetrievers.length||t.hasKnownLength&&t.hasKnownLength())?t.getLengthSync():null}k.prototype={get body(){return this[P].body},get bodyUsed(){return this[P].disturbed},arrayBuffer:function(){return C.call(this).then((function(e){return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}))},blob:function(){var e=this.headers&&this.headers.get("content-type")||"";return C.call(this).then((function(t){return Object.assign(new j([],{type:e.toLowerCase()}),(o=t,(n=S)in(r={})?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r));var r,n,o}))},json:function(){var e=this;return C.call(this).then((function(t){try{return JSON.parse(t.toString())}catch(t){return k.Promise.reject(new E("invalid json response body at ".concat(e.url," reason: ").concat(t.message),"invalid-json"))}}))},text:function(){return C.call(this).then((function(e){return e.toString()}))},buffer:function(){return C.call(this)},textConverted:function(){var e=this;return C.call(this).then((function(t){return function(e,t){if("function"!=typeof T)throw new Error("The package `encoding` must be installed to use the textConverted() function");var r,n,o=t.get("content-type"),a="utf-8";o&&(r=/charset=([^;]*)/i.exec(o));n=e.slice(0,1024).toString(),!r&&n&&(r=/<meta.+?charset=(['"])(.+?)\1/i.exec(n));!r&&n&&(r=/<meta[\s]+?http-equiv=(['"])content-type\1[\s]+?content=(['"])(.+?)\2/i.exec(n))&&(r=/charset=(.*)/i.exec(r.pop()));!r&&n&&(r=/<\?xml.+?encoding=(['"])(.+?)\1/i.exec(n));r&&("gb2312"!==(a=r.pop())&&"gbk"!==a||(a="gb18030"));return T(e,"UTF-8",a).toString()}(t,e.headers)}))}},Object.defineProperties(k.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},blob:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}}),k.mixIn=function(e){var t,r=m(Object.getOwnPropertyNames(k.prototype));try{for(r.s();!(t=r.n()).done;){var n=t.value;if(!(n in e)){var o=Object.getOwnPropertyDescriptor(k.prototype,n);Object.defineProperty(e,n,o)}}}catch(e){r.e(e)}finally{r.f()}},k.Promise=global.Promise;var L=/[^\^_`a-zA-Z\-0-9!#$%&'*+.|~]/,q=/[^\t\x20-\x7e\x80-\xff]/;function H(e){if(e="".concat(e),L.test(e))throw new TypeError("".concat(e," is not a legal HTTP header name"))}function N(e){if(e="".concat(e),q.test(e))throw new TypeError("".concat(e," is not a legal HTTP header value"))}function z(e,t){for(var r in t=t.toLowerCase(),e)if(r.toLowerCase()===t)return r}var U=Symbol("map"),M=function(){function e(){l(this,e);var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(this[U]=Object.create(null),t instanceof e)for(var r=t.raw(),n=Object.keys(r),o=0,a=n;o<a.length;o++){var i,s=a[o],c=m(r[s]);try{for(c.s();!(i=c.n()).done;){var f=i.value;this.append(s,f)}}catch(e){c.e(e)}finally{c.f()}}else if(null==t);else{if("object"!==u(t))throw new TypeError("Provided initializer must be an object");var d=t[Symbol.iterator];if(null!=d){if("function"!=typeof d)throw new TypeError("Header pairs must be iterable");var h,p=[],y=m(t);try{for(y.s();!(h=y.n()).done;){var b=h.value;if("object"!==u(b)||"function"!=typeof b[Symbol.iterator])throw new TypeError("Each header pair must be iterable");p.push(Array.from(b))}}catch(e){y.e(e)}finally{y.f()}for(var v=0,g=p;v<g.length;v++){var w=g[v];if(2!==w.length)throw new TypeError("Each header pair must be a name/value tuple");this.append(w[0],w[1])}}else for(var S=0,O=Object.keys(t);S<O.length;S++){var j=O[S],E=t[j];this.append(j,E)}}}return d(e,[{key:"get",value:function(e){H(e="".concat(e));var t=z(this[U],e);return void 0===t?null:this[U][t].join(", ")}},{key:"forEach",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=I(this),n=0;n<r.length;){var o=r[n],a=o[0],i=o[1];e.call(t,i,a,this),r=I(this),n++}}},{key:"set",value:function(e,t){e="".concat(e),t="".concat(t),H(e),N(t);var r=z(this[U],e);this[U][void 0!==r?r:e]=[t]}},{key:"append",value:function(e,t){e="".concat(e),t="".concat(t),H(e),N(t);var r=z(this[U],e);void 0!==r?this[U][r].push(t):this[U][e]=[t]}},{key:"has",value:function(e){return H(e="".concat(e)),void 0!==z(this[U],e)}},{key:"delete",value:function(e){H(e="".concat(e));var t=z(this[U],e);void 0!==t&&delete this[U][t]}},{key:"raw",value:function(){return this[U]}},{key:"keys",value:function(){return G(this,"key")}},{key:"values",value:function(){return G(this,"value")}},{key:Symbol.iterator,value:function(){return G(this,"key+value")}}]),e}();function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"key+value",r=Object.keys(e[U]).sort();return r.map("key"===t?function(e){return e.toLowerCase()}:"value"===t?function(t){return e[U][t].join(", ")}:function(t){return[t.toLowerCase(),e[U][t].join(", ")]})}M.prototype.entries=M.prototype[Symbol.iterator],Object.defineProperty(M.prototype,Symbol.toStringTag,{value:"Headers",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(M.prototype,{get:{enumerable:!0},forEach:{enumerable:!0},set:{enumerable:!0},append:{enumerable:!0},has:{enumerable:!0},delete:{enumerable:!0},keys:{enumerable:!0},values:{enumerable:!0},entries:{enumerable:!0}});var $=Symbol("internal");function G(e,t){var r=Object.create(D);return r[$]={target:e,kind:t,index:0},r}var D=Object.setPrototypeOf({next:function(){if(!this||Object.getPrototypeOf(this)!==D)throw new TypeError("Value of `this` is not a HeadersIterator");var e=this[$],t=e.target,r=e.kind,n=e.index,o=I(t,r);return n>=o.length?{value:void 0,done:!0}:(this[$].index=n+1,{value:o[n],done:!1})}},Object.getPrototypeOf(Object.getPrototypeOf([][Symbol.iterator]())));function F(e){var t=Object.assign({__proto__:null},e[U]),r=z(e[U],"Host");return void 0!==r&&(t[r]=t[r][0]),t}Object.defineProperty(D,Symbol.toStringTag,{value:"HeadersIterator",writable:!1,enumerable:!1,configurable:!0});var J=o.STATUS_CODES,K=Symbol("Response internals"),Y=function(){function e(){l(this,e);var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};k.call(this,t,r);var n=r.status||200;this[K]={url:r.url,status:n,statusText:r.statusText||J[n],headers:new M(r.headers)}}return d(e,[{key:"clone",value:function(){return new e(_(this),{url:this.url,status:this.status,statusText:this.statusText,headers:this.headers,ok:this.ok})}},{key:"url",get:function(){return this[K].url}},{key:"status",get:function(){return this[K].status}},{key:"ok",get:function(){return this[K].status>=200&&this[K].status<300}},{key:"statusText",get:function(){return this[K].statusText}},{key:"headers",get:function(){return this[K].headers}}]),e}();k.mixIn(Y.prototype),Object.defineProperties(Y.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}}),Object.defineProperty(Y.prototype,Symbol.toStringTag,{value:"Response",writable:!1,enumerable:!1,configurable:!0});var Q=a.format,Z=a.parse,V=Symbol("Request internals");function W(e){return"object"===u(e)&&"object"===u(e[V])}var X=function(){function e(t){l(this,e);var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};W(t)?r=Z(t.url):(r=t&&t.href?Z(t.href):Z("".concat(t)),t={});var o=n.method||t.method||"GET";if(o=o.toUpperCase(),(null!=n.body||W(t)&&null!==t.body)&&("GET"===o||"HEAD"===o))throw new TypeError("Request with GET/HEAD method cannot have body");var a=null!=n.body?n.body:W(t)&&null!==t.body?_(t):null;k.call(this,a,{timeout:n.timeout||t.timeout||0,size:n.size||t.size||0});var i=new M(n.headers||t.headers||{});if(null!=n.body){var s=B(this);null===s||i.has("Content-Type")||i.append("Content-Type",s)}this[V]={method:o,redirect:n.redirect||t.redirect||"follow",headers:i,parsedURL:r},this.follow=void 0!==n.follow?n.follow:void 0!==t.follow?t.follow:20,this.compress=void 0!==n.compress?n.compress:void 0===t.compress||t.compress,this.counter=n.counter||t.counter||0,this.agent=n.agent||t.agent}return d(e,[{key:"clone",value:function(){return new e(this)}},{key:"method",get:function(){return this[V].method}},{key:"url",get:function(){return Q(this[V].parsedURL)}},{key:"headers",get:function(){return this[V].headers}},{key:"redirect",get:function(){return this[V].redirect}}]),e}();k.mixIn(X.prototype),Object.defineProperty(X.prototype,Symbol.toStringTag,{value:"Request",writable:!1,enumerable:!1,configurable:!0}),Object.defineProperties(X.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},clone:{enumerable:!0}});var ee=o,te=r.PassThrough,re=a.resolve;function ne(e,t){if(!ne.Promise)throw new Error("native promise missing, set fetch.Promise to your favorite alternative");return k.Promise=ne.Promise,new ne.Promise((function(r,n){var o,a,u,c=new X(e,t),l=function(e){var t=e[V].parsedURL,r=new M(e[V].headers);if(r.has("Accept")||r.set("Accept","*/*"),!t.protocol||!t.hostname)throw new TypeError("Only absolute URLs are supported");if(!/^https?:$/.test(t.protocol))throw new TypeError("Only HTTP(S) protocols are supported");var n=null;if(null==e.body&&/^(POST|PUT)$/i.test(e.method)&&(n="0"),null!=e.body){var o=R(e);"number"==typeof o&&(n=String(o))}return n&&r.set("Content-Length",n),r.has("User-Agent")||r.set("User-Agent","node-fetch/1.0 (+https://github.com/bitinn/node-fetch)"),e.compress&&r.set("Accept-Encoding","gzip,deflate"),r.has("Connection")||e.agent||r.set("Connection","close"),Object.assign({},t,{method:e.method,headers:F(r),agent:e.agent})}(c),f=(0,("https:"===l.protocol?i:ee).request)(l);function d(){f.abort(),clearTimeout(o)}c.timeout&&f.once("socket",(function(e){o=setTimeout((function(){n(new E("network timeout at: ".concat(c.url),"request-timeout")),d()}),c.timeout)})),f.on("error",(function(e){n(new E("request to ".concat(c.url," failed, reason: ").concat(e.message),"system",e)),d()})),f.on("response",(function(e){clearTimeout(o);var t=function(e){for(var t=new M,r=0,n=Object.keys(e);r<n.length;r++){var o=n[r];if(!L.test(o))if(Array.isArray(e[o])){var a,i=m(e[o]);try{for(i.s();!(a=i.n()).done;){var s=a.value;q.test(s)||(void 0===t[U][o]?t[U][o]=[s]:t[U][o].push(s))}}catch(e){i.e(e)}finally{i.f()}}else q.test(e[o])||(t[U][o]=[e[o]])}return t}(e.headers);if(ne.isRedirect(e.statusCode)){var a=t.get("Location"),i=null===a?null:re(c.url,a);switch(c.redirect){case"error":return n(new E("redirect mode is set to error: ".concat(c.url),"no-redirect")),void d();case"manual":null!==i&&t.set("Location",i);break;case"follow":if(null===i)break;if(c.counter>=c.follow)return n(new E("maximum redirect reached at: ".concat(c.url),"max-redirect")),void d();var u={headers:new M(c.headers),follow:c.follow,counter:c.counter+1,agent:c.agent,compress:c.compress,method:c.method,body:c.body};return 303!==e.statusCode&&c.body&&null===R(c)?(n(new E("Cannot follow redirect with body being a readable stream","unsupported-redirect")),void d()):(303!==e.statusCode&&(301!==e.statusCode&&302!==e.statusCode||"POST"!==c.method)||(u.method="GET",u.body=void 0,u.headers.delete("content-length")),r(ne(new X(i,u))),void d())}}var l=e.pipe(new te),f={url:c.url,status:e.statusCode,statusText:e.statusMessage,headers:t,size:c.size,timeout:c.timeout},h=t.get("Content-Encoding");if(c.compress&&"HEAD"!==c.method&&null!==h&&204!==e.statusCode&&304!==e.statusCode){var p={flush:s.Z_SYNC_FLUSH,finishFlush:s.Z_SYNC_FLUSH};if("gzip"==h||"x-gzip"==h)return l=l.pipe(s.createGunzip(p)),void r(new Y(l,f));if("deflate"!=h&&"x-deflate"!=h)r(new Y(l,f));else e.pipe(new te).once("data",(function(e){l=8==(15&e[0])?l.pipe(s.createInflate()):l.pipe(s.createInflateRaw()),r(new Y(l,f))}))}else r(new Y(l,f))})),a=f,null===(u=c.body)?a.end():"string"==typeof u?(a.write(u),a.end()):A(u)?(a.write(Buffer.from(String(u))),a.end()):u instanceof j?(a.write(u[S]),a.end()):Buffer.isBuffer(u)?(a.write(u),a.end()):"[object ArrayBuffer]"===Object.prototype.toString.call(u)?(a.write(Buffer.from(u)),a.end()):u.pipe(a)}))}ne.isRedirect=function(e){return 301===e||302===e||303===e||307===e||308===e},ne.default=ne,ne.Promise=global.Promise;var oe=g((function(e,t){var r=ne.default||ne,n=function(e,t){return/^\/\//.test(e)&&(e="https:"+e),r.call(this,e,t)};n.polyfill=!1,e.exports=t=n,t.fetch=n,t.Headers=ne.Headers,t.Request=ne.Request,t.Response=ne.Response,t.default=n})),ae=(oe.fetch,oe.Headers,oe.Request,oe.Response,oe.fetch.bind({}));ae.polyfill=!0,b.fetch||(b.fetch=ae,b.Response=oe.Response,b.Headers=oe.Headers,b.Request=oe.Request);var ie=g((function(e,t){var r=b&&b.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n=b&&b.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,a){function i(e){try{u(n.next(e))}catch(e){a(e)}}function s(e){try{u(n.throw(e))}catch(e){a(e)}}function u(e){e.done?o(e.value):new r((function(t){t(e.value)})).then(i,s)}u((n=n.apply(e,t||[])).next())}))},o=b&&b.__generator||function(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=n[2&a[0]?"return":a[0]?"throw":"next"])&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},a=b&&b.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&(r[n[o]]=e[n[o]])}return r};Object.defineProperty(t,"__esModule",{value:!0});var i=w;t.ClientError=i.ClientError;var s=function(){function e(e,t){this.url=e,this.options=t||{}}return e.prototype.rawRequest=function(e,t){return n(this,void 0,void 0,(function(){var n,i,s,u,l,f,d,h,p;return o(this,(function(o){switch(o.label){case 0:return n=this.options,i=n.headers,s=a(n,["headers"]),u=JSON.stringify({query:e,variables:t||void 0}),[4,fetch(this.url,r({method:"POST",headers:Object.assign({"Content-Type":"application/json"},i),body:u},s))];case 1:return[4,c(l=o.sent())];case 2:if(f=o.sent(),l.ok&&!f.errors&&f.data)return d=l.headers,h=l.status,[2,r({},f,{headers:d,status:h})];throw p="string"==typeof f?{error:f}:f,new w.ClientError(r({},p,{status:l.status,headers:l.headers}),{query:e,variables:t})}}))}))},e.prototype.request=function(e,t){return n(this,void 0,void 0,(function(){var n,i,s,u,l,f,d;return o(this,(function(o){switch(o.label){case 0:return n=this.options,i=n.headers,s=a(n,["headers"]),u=JSON.stringify({query:e,variables:t||void 0}),[4,fetch(this.url,r({method:"POST",headers:Object.assign({"Content-Type":"application/json"},i),body:u},s))];case 1:return[4,c(l=o.sent())];case 2:if(f=o.sent(),l.ok&&!f.errors&&f.data)return[2,f.data];throw d="string"==typeof f?{error:f}:f,new w.ClientError(r({},d,{status:l.status}),{query:e,variables:t})}}))}))},e.prototype.setHeaders=function(e){return this.options.headers=e,this},e.prototype.setHeader=function(e,t){var r,n=this.options.headers;return n?n[e]=t:this.options.headers=((r={})[e]=t,r),this},e}();function u(e,t,r){return n(this,void 0,void 0,(function(){return o(this,(function(n){return[2,new s(e).request(t,r)]}))}))}function c(e){return n(this,void 0,void 0,(function(){var t;return o(this,(function(r){return(t=e.headers.get("Content-Type"))&&t.startsWith("application/json")?[2,e.json()]:[2,e.text()]}))}))}t.GraphQLClient=s,t.rawRequest=function(e,t,r){return n(this,void 0,void 0,(function(){return o(this,(function(n){return[2,new s(e).rawRequest(t,r)]}))}))},t.request=u,t.default=u}));v(ie);ie.ClientError,ie.GraphQLClient,ie.rawRequest,ie.request;var se=ie.GraphQLClient,ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.apiKey,r=e.domain;return new se("http://localhost:4000/graphql",{headers:{"Content-Type":"application/json","x-api-key":t,"x-domain":r}})},ce=process.env.GATSBY_JAM_COMMENTS_API_KEY,le=process.env.GATSBY_JAM_COMMENTS_DOMAIN,fe=function(){var r=t(null),n=function(){var e,t=(e=regeneratorRuntime.mark((function e(t){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=h(r.current.elements).reduce((function(e,t){return e[t.name]=t.value,e}),{}),o={name:n.name,content:n.content,twitterHandle:n.twitterHandle,emailAddress:n.emailAddress,path:window.location.pathname},e.next=6,ue({apiKey:ce,domain:le}).request("\n                mutation CreateComment($name: String!, $path: String!, $content: String!, $twitterHandle: String, $emailAddress: String){\n                    createComment(name: $name, path: $path, content: $content, twitterHandle: $twitterHandle, emailAddress: $emailAddress) {\n                        createdAt\n                        name\n                        twitterHandle\n                        emailAddress\n                        content\n                    }\n                }",o);case 6:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var a=e.apply(t,r);function i(e){c(a,n,o,i,s,"next",e)}function s(e){c(a,n,o,i,s,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}();return e.createElement("form",{onSubmit:n,ref:r,className:"box"},e.createElement("label",{className:styles.label},"Comment",e.createElement("textarea",{name:"content",required:!0})),e.createElement("label",{className:styles.label},"Name",e.createElement("input",{type:"text",name:"name",required:!0})),e.createElement("label",{className:styles.label},"Email Address",e.createElement("input",{type:"email",name:"emailAddress"})),e.createElement("label",{className:styles.label},"Twitter Handle",e.createElement("input",{type:"text",name:"twitterHandle"})),e.createElement("button",null,"Submit"))},de=function(t){var r=t.comments;return e.createElement("ul",{className:styles.list},r.map((function(t){return e.createElement("li",{key:t.id,className:styles.comment},e.createElement("span",{className:styles.deets},e.createElement("h6",{className:styles.name},t.name),e.createElement("span",{className:styles.date},(r=t.createdAt,n=new Date(Number(r)),o=n.getTimezoneOffset()/60,n.setHours(n.getHours()-o),n.toLocaleString("en-US").split(",")[0].trim()))),e.createElement("div",{className:styles.content},e.createElement("p",null,t.content)));var r,n,o})))};export default function(t){var r=t.pageContext.comments||[];return e.createElement("div",{className:styles.shell},e.createElement("h3",null,"Comments"),e.createElement(fe,null),e.createElement(de,{comments:r}))}
